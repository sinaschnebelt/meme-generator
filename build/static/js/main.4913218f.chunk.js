(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{25:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),s=n(11),i=n.n(s),r=n(3),c=n(4),d=n(7),l=n(6),m=n(5),h=n(10),u=n.n(h),g=n(12),p=n(15),j=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).saveImageToDB=function(e){console.log(e);var t=new FormData;t.append("imageName",a.getFormattedTime()+"_"+a.props.memeTitle),t.append("imageData",a.props.editedMemeToSave);var n,o=new URLSearchParams,s=Object(p.a)(t);try{for(s.s();!(n=s.n()).done;){var i=n.value;o.append(i[0],i[1])}}catch(r){s.e(r)}finally{s.f()}fetch("/image/upload",{mode:"cors",method:"POST",body:o}).then((function(e){200===e.status&&console.log("Image has been uploaded to database")})).catch((function(e){console.log(e)}))},a}return Object(c.a)(n,[{key:"getImageByName",value:function(e){var t="/image/singleMeme?"+new URLSearchParams({name:e}).toString();fetch(t).then((function(e){if("200"===e.status)return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))}},{key:"getFormattedTime",value:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds()}},{key:"render",value:function(){return Object(a.jsx)("button",{type:"button",id:"memesaver",onClick:this.saveImageToDB,children:"Save meme"})}}]),n}(o.Component),f=n(8),b=["image/png","image/jpg","image/jpeg","image/gif"],v=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).uploadImage=function(e){var t=e.target.files[0];if(!0!==b.includes(t.type))alert("Sorry, "+t.type+" is invalid file type, allowed file types are: "+b.join(", "));else{a.saveImageToDB();var n=new FileReader;n.readAsDataURL(t),n.onloadend=function(e){a.addImageProcess(n.result).then((function(e){a.setState({currentImg:{src:e.src,width:e.width,height:e.height,name:t.name}}),document.getElementById("file-chosen").innerHTML=t.name}))}}},a.enlargeImage=function(e){var t={src:e.src,width:e.width,height:e.height,name:e.name};a.setState({selectedMeme:t})},a.state={currentImg:{},selectedFile:{}},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"addImageProcess",value:function(e){return new Promise((function(t,n){var a=new Image;a.src=e,a.onload=function(){t(a)},a.onerror=n}))}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{className:"btn-wrapper",children:[Object(a.jsxs)("label",{htmlFor:"uploadBtn",children:[Object(a.jsx)(f.b,{})," Lade eigenes Bild hoch"]}),Object(a.jsx)("span",{id:"file-chosen"}),Object(a.jsx)("input",{type:"file",id:"uploadBtn",hidden:!0,onChange:function(t){return e.uploadImage(t,"upload")}})]})}}]),n}(o.Component),x=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).drawMeme=function(){if(""===a.state.dHeight){var e=document.getElementById("selectedMeme").height,t=document.getElementById("selectedMeme").width;a.setState({dHeight:e,dWidth:t})}var n=a.state.canvas,o=n.getContext("2d");o.canvas.width=a.state.dWidth,o.canvas.height=a.state.dHeight;var s="",i=new Image;i.crossOrigin="anonymous",i.onload=Object(g.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.drawImage(i,0,0,a.state.dWidth,a.state.dHeight),o.font=a.state.fontStyle+" normal "+a.state.fontWeight+" "+a.state.fontSize+" "+a.state.font,o.fillStyle=a.state.color,o.fillText(a.state.caption,a.state.textXCoord,a.state.textYCoord),e.next=6,n.toDataURL();case 6:s=e.sent,a.setState({temporaryImg:s});case 8:case"end":return e.stop()}}),e)}))),a.state.addButtonClicked?i.src=a.state.base64Img:i.src=a.props.rawImageSrc},a.drawByHand=function(){document.getElementById("capInput").value="";var e=document.getElementById("handDrawnCanvas"),t=e.getContext("2d");if(e.style.display="block",a.setState({drawnByHand:!0}),""===a.state.dHeight){var n=document.getElementById("selectedMeme").height,o=document.getElementById("selectedMeme").width;a.setState({dHeight:n,dWidth:o})}t.canvas.width=a.state.dWidth,t.canvas.height=a.state.dHeight;var s=new Image;s.crossOrigin="anonymous",s.onload=function(){t.drawImage(s,0,0,a.state.dWidth,a.state.dHeight)},a.state.addButtonClicked?s.src=a.state.base64Img:s.src=a.props.rawImageSrc},a.drawLine=function(e){var t=document.getElementById("handDrawnCanvas").getContext("2d");1===e.buttons&&(t.beginPath(),t.lineWidth=5,t.strokeStyle=a.state.color,t.moveTo(a.state.posX,a.state.posY),a.setPosition(e),t.lineTo(a.state.posX,a.state.posY),t.stroke(),t.closePath())},a.endDrawByHand=function(){var e=document.getElementById("handDrawnCanvas");e.style.display="none",document.getElementById("capInput").value="";var t;t=e.toDataURL(),a.setState({addButtonClicked:!0,base64Img:t,drawnByHand:!1,temporaryImg:t})},a.setPosition=function(e){var t=document.getElementById("handDrawnCanvas").getBoundingClientRect().left,n=document.getElementById("handDrawnCanvas").getBoundingClientRect().top;a.setState({posX:e.clientX-t,posY:e.clientY-n})},a.showCaption=function(e){!1===a.state.drawnByHand?(a.setState({caption:e.target.value}),a.drawMeme()):alert("Hand drawing mode needs to closed first")},a.boldFormatting=function(e){var t="normal"===a.state.fontWeight?"bold":"normal";a.setState({fontWeight:t}),a.drawMeme()},a.italicFormatting=function(e){var t="normal"===a.state.fontStyle?"italic":"normal";a.setState({fontStyle:t}),a.drawMeme()},a.font=function(e){a.setState({font:e.target.value}),a.drawMeme()},a.fontSizeFormatting=function(e){a.setState({fontSize:e.target.value}),a.drawMeme()},a.fontColorFormatting=function(e){a.setState({color:e.target.value}),a.drawMeme()},a.moveLeft=function(){a.setState((function(e){return{textXCoord:e.textXCoord-50}})),a.drawMeme()},a.moveUp=function(){a.setState((function(e){return{textYCoord:e.textYCoord-50}})),a.drawMeme()},a.moveRight=function(){a.setState((function(e){return{textXCoord:e.textXCoord+50}})),a.drawMeme()},a.moveDown=function(){a.setState((function(e){return{textYCoord:e.textYCoord+50}})),a.drawMeme()},a.permanentlyAddCaption=function(){document.getElementById("capInput").value="",a.setState({addButtonClicked:!0,base64Img:a.state.temporaryImg,caption:"",textYCoord:a.state.textYCoord+150},a.drawMeme)},a.changeMemeTitle=function(e){e.target.value,a.setState({memeTitle:e.target.value}),a.drawMeme()},a.state={addButtonClicked:!1,base64Img:"",canvas:"",caption:"",color:"black",dHeight:"",dWidth:"",drawnByHand:!1,font:"Arial",fontSize:"72px",fontStyle:"normal",fontWeight:"normal",posX:0,posY:0,temporaryImg:"",textXCoord:100,textYCoord:100,saveButtonDisabled:!0,memeTitle:""},a._isMounted=!1,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=document.createElement("canvas");this.setState({canvas:e});var t=document.getElementById("handDrawnCanvas");t.addEventListener("mouseenter",this.setPosition),t.addEventListener("mousedown",this.setPosition),t.addEventListener("mousemove",this.drawLine)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidUpdate",value:function(e){this.props.rawImageSrc!==e.rawImageSrc&&(document.getElementById("capInput").value="",this.setState({addButtonClicked:!1,caption:"",color:"black",dHeight:"",dWidth:"",drawnByHand:!1,font:"sans-serif",fontSize:"72px",fontStyle:"normal",fontWeight:"normal",posX:0,posY:0,temporaryImg:this.props.rawImageSrc,textXCoord:100,textYCoord:100,saveButtonDisabled:!0}))}},{key:"render",value:function(){var e;return!1===this.state.drawnByHand&&(e=this.state.temporaryImg.length<7?Object(a.jsx)("img",{id:"selectedMeme",src:this.props.rawImageSrc,alt:"Can't be displayed",useMap:"#planetmap"}):Object(a.jsx)("img",{id:"selectedMeme",src:this.state.temporaryImg,alt:"Can't be displayed",useMap:"#planetmap"})),Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"text",id:"ImageCaption",placeholder:"Image Title",name:"ImageCaption",onChange:this.changeMemeTitle}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{className:"image",id:"image",children:[e,Object(a.jsx)("canvas",{id:"handDrawnCanvas",style:{zIndex:"2",display:"none",width:this.state.dWidth,height:this.state.dHeight,margin:"auto"}})]}),Object(a.jsx)("div",{children:this.state.showSavedImage})," ",Object(a.jsx)("div",{className:"cap",id:"cap",style:{color:this.state.color,fontSize:this.state.fontSize,fontWeight:this.state.fontWeight,fontStyle:this.state.fontStyle}}),Object(a.jsx)("button",{onClick:this.drawByHand,children:"Start hand drawing mode"}),Object(a.jsx)("button",{onClick:this.endDrawByHand,children:"End hand drawing mode"}),Object(a.jsxs)("div",{className:"Formatting",children:[Object(a.jsx)("button",{onClick:this.boldFormatting,children:Object(a.jsx)("strong",{children:"B"})}),Object(a.jsx)("button",{onClick:this.italicFormatting,children:Object(a.jsx)("em",{children:"I"})}),Object(a.jsxs)("select",{name:"FontSize",onChange:this.fontSizeFormatting,children:[Object(a.jsx)("option",{value:"84px",children:"84"}),Object(a.jsx)("option",{value:"72px",children:"72"}),Object(a.jsx)("option",{value:"64px",children:"64"}),Object(a.jsx)("option",{value:"32px",children:"32"})]}),Object(a.jsxs)("select",{name:"Font",onChange:this.font,children:[Object(a.jsx)("option",{value:"Arial",children:"Arial"}),Object(a.jsx)("option",{value:"Times",children:"Times"}),Object(a.jsx)("option",{value:"Andale Mono",children:"Andale Mono"}),Object(a.jsx)("option",{value:"Comic Sans MS",children:"Comic Sans MS"})]}),Object(a.jsx)("input",{type:"color",onChange:this.fontColorFormatting}),Object(a.jsx)("button",{onClick:this.moveLeft,children:"\u2190"}),Object(a.jsx)("button",{onClick:this.moveUp,children:"\u2191"}),Object(a.jsx)("button",{onClick:this.moveRight,children:"\u2192"}),Object(a.jsx)("button",{onClick:this.moveDown,children:"\u2193"}),Object(a.jsx)("button",{onClick:this.permanentlyAddCaption,children:"Add text permanently to image"})]}),Object(a.jsx)("input",{type:"text",id:"capInput",placeholder:"Add text",name:"capInput",onChange:this.showCaption}),Object(a.jsx)("div",{className:"btn-wrapper",children:Object(a.jsx)("label",{children:Object(a.jsxs)("a",{href:this.state.temporaryImg,download:!0,children:[Object(a.jsx)(f.a,{}),"Meme speichern"]})})}),Object(a.jsx)(j,{editedMemeToSave:this.state.temporaryImg,memeTitle:this.state.memeTitle}),Object(a.jsx)(v,{enlargeImage:this.props.enlargeImage})]})}}]),n}(o.Component),O=n(13),w=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).enlargeImage=function(e){var t={src:e.src,width:e.width,height:e.height,name:e.name};a.setState({selectedMeme:t})},a.showmoreMemes=function(e){var t=[];fetch("/samplememes",{mode:"cors",method:"get",headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){return e.json()})).then((function(e){for(var n in e){var o={src:e[n].url,width:e[n].width,height:e[n].height};t.push(o)}a.setState({isLoaded:!0,memes:t,selectedMeme:t[0]})}))},a.state={isLoaded:!1,error:null,memes:[],selectedMeme:null},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("https://api.imgflip.com/get_memes").then((function(e){return e.json()})).then((function(t){var n=[];t.data.memes.forEach((function(e){var t={src:e.url,width:e.width,height:e.height};n.length<10&&n.push(t)})),e.setState({isLoaded:!0,memes:n,selectedMeme:n[0]})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,o=t.memes,s=t.selectedMeme,i=t.isLoaded;return n?Object(a.jsxs)("div",{children:["Error: ",n.message]}):i?Object(a.jsxs)("div",{className:"container",width:"300px",children:[Object(a.jsx)("h1",{children:"OMM Exercise 1"}),Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(x,{rawImageSrc:s.src})}),Object(a.jsxs)("div",{className:"galleryContainer",children:[Object(a.jsx)("button",{type:"button",id:"samplememes",onClick:this.showmoreMemes,children:"Show more memes"}),Object(a.jsx)(O.a,{photos:o,onClick:function(t){return e.enlargeImage(t.target)},margin:5})]})]}):Object(a.jsx)("div",{children:"Loading..."})}}]),n}(o.Component),y=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleUserNameChange=function(e){a.setState({userName:e.target.value})},a.handleUserPasswordChange=function(e){a.setState({userPassword:e.target.value})},a.login=function(){a.props.setToken("true");var e={userName:a.state.userName,userPassword:a.state.userPassword};fetch("/users/createUser",{method:"post",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Accept:"application/json"},body:JSON.stringify(e)}).then((function(e){200===e.status&&console.log("User has been stored to database")})).catch((function(e){return console.log(e.response.request)}))},a.state={userName:"",userPassword:""},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{className:"loginform-wrapper",children:Object(a.jsxs)("div",{className:"loginform",children:[Object(a.jsx)("h1",{id:"logincaption",children:"Please Log In"}),Object(a.jsxs)("form",{children:[Object(a.jsxs)("label",{children:[Object(a.jsx)("p",{children:"Username"}),Object(a.jsx)("input",{type:"text",value:this.state.userName,onChange:this.handleUserNameChange})]}),Object(a.jsxs)("label",{children:[Object(a.jsx)("p",{children:"Password"}),Object(a.jsx)("input",{type:"password",value:this.state.userPassword,onChange:this.handleUserPasswordChange})]}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{type:"submit",onClick:function(){e.login()},children:"Submit"})})]})]})})}}]),n}(o.Component),C=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).setToken=function(e){a.setState({token:e}),sessionStorage.setItem("token",JSON.stringify(e))},a.setToken=a.setToken.bind(Object(d.a)(a)),a.state={token:null},a}return Object(c.a)(n,[{key:"render",value:function(){var e;return e=null===this.state.token?Object(a.jsx)(y,{token:this.state.token,setToken:this.setToken}):Object(a.jsx)(w,{}),Object(a.jsx)("div",{children:e})}}]),n}(o.Component);n(25),n(26);i.a.render(Object(a.jsx)(C,{}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.4913218f.chunk.js.map